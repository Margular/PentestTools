#!/usr/bin/env python3

import pymysql

host = 'localhost'
username = 'root'
password = 'root'
database = 'social1'
charset = 'utf8'
blocksize = 10000000

conn = pymysql.connect(host, username, password, database, charset = charset)
cur = conn.cursor()
table = 'gfan'
# 取得条数
cur.execute("SELECT COUNT(*) FROM " + table)
for each in cur:
    count = each[0]
for x in range(0, count+1, blocksize):
    number = int(x / blocksize + 1)
    print("现在生成表{}{}......".format(table, number))
    cur.execute("CREATE TABLE `{}{}` SELECT * FROM `{}` LIMIT {},{};".format(table, number, table, x, blocksize))
